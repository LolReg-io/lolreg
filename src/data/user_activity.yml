name: "User Activity Artifacts"
description: "Registry keys tracking user activity including recently accessed files, typed paths, program execution history, and shell interactions. Essential for forensic timeline reconstruction."
tags:
  - forensics
keys:
  - 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs'
  - 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths'
  - 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist'
  - 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32'
  - 'HKCU\Software\Microsoft\Windows\Shell\BagMRU'
  - 'HKCU\Software\Microsoft\Windows\Shell\Bags'
  - 'HKCU\Software\Microsoft\Windows\CurrentVersion\Applets'
resources:
  - link: https://www.sans.org/blog/opensourcesoftware-windows-forensics/
  - link: https://github.com/EricZimmerman/RECmd
use_cases:
  - title: "View recently accessed documents"
    description: "Lists files accessed through Windows Explorer shell."
    code: |
      reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs" /s
  - title: "Check typed paths in Explorer"
    description: "Shows paths manually typed into Explorer address bar."
    code: |
      reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths"
  - title: "Decode UserAssist entries"
    description: "UserAssist tracks program execution with ROT13 encoded paths and run counts."
    code: |
      reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist" /s
  - title: "Analyze ShellBags for folder access"
    description: "ShellBags record folder access even for deleted/removable media folders."
    code: |
      reg query "HKCU\Software\Microsoft\Windows\Shell\BagMRU" /s
