name: "Known Malware Registry Indicators"
description: "Registry keys and values created by known malware families. These are documented IOCs from forensic analysis of malware samples including Renocide, Ilomo/Clampi, Virut, and others."
tags:
  - forensics
  - malware
keys:
  - 'HKLM\SOFTWARE\Microsoft\DRM\amty'
  - 'HKLM\SOFTWARE\Microsoft\9593275321'
  - 'HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer'
resources:
  - link: https://www.microsoft.com/en-us/wdsi/threats
  - link: https://attack.mitre.org/software/
use_cases:
  - title: "Check for Renocide malware"
    description: "Renocide creates the 'amty' key under DRM to store configuration."
    code: |
      reg query "HKLM\SOFTWARE\Microsoft\DRM\amty"
  - title: "Check for Ilomo/Clampi malware"
    description: "Some Ilomo variants create a numeric key under Microsoft."
    code: |
      reg query "HKLM\SOFTWARE\Microsoft\9593275321"
  - title: "Check for Virut indicators"
    description: "Virut adds 'UpdateHost' value to Explorer key."
    code: |
      reg query "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer" /v "UpdateHost"
  - title: "Scan for suspicious numeric keys"
    description: "Searches for unusual numeric subkeys under Microsoft that may indicate malware."
    code: |
      reg query "HKLM\SOFTWARE\Microsoft" | findstr /r "^HKEY.*\\[0-9][0-9]*$"
